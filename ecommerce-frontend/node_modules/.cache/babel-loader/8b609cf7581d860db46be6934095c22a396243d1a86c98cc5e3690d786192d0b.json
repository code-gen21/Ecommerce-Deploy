{"ast":null,"code":"import _objectSpread from\"C:/Users/kandw/Desktop/Ecommerce/ecommerce-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/kandw/Desktop/Ecommerce/ecommerce-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import{useSelector}from'react-redux';import axios from'../axios';import Loading from'./Loading.js';import{Badge,Button,Modal,Table}from'react-bootstrap';import Pagination from'./Pagination';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function OrdersAdminPage(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),orders=_useState2[0],setOrders=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var products=useSelector(function(state){return state.products;});var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),orderToShow=_useState6[0],setOrderToShow=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),show=_useState8[0],setShow=_useState8[1];var handleClose=function handleClose(){return setShow(false);};function markShipped(orderId,ownerId){axios.patch(\"/orders/\".concat(orderId,\"/mark-shipped\"),{ownerId:ownerId}).then(function(_ref){var data=_ref.data;return setOrders(data);}).catch(function(e){return console.log(e);});}function showOrder(productsObj){var productsToShow=products.filter(function(product){return productsObj[product._id];});productsToShow=productsToShow.map(function(product){var productCopy=_objectSpread({},product);productCopy.count=productsObj[product._id];delete productCopy.description;return productCopy;});setShow(true);setOrderToShow(productsToShow);}useEffect(function(){setLoading(true);axios.get('/orders').then(function(_ref2){var data=_ref2.data;setLoading(false);setOrders(data);}).catch(function(e){setLoading(false);});},[]);if(loading){return/*#__PURE__*/_jsx(Loading,{});}if(orders.length===0){return/*#__PURE__*/_jsx(\"h1\",{className:\"text-center pt-4\",children:\"No orders yet\"});}function TableRow(_ref3){var _id=_ref3._id,count=_ref3.count,owner=_ref3.owner,total=_ref3.total,status=_ref3.status,products=_ref3.products,address=_ref3.address;{orders.map(function(order){var _order$owner;return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:order._id}),/*#__PURE__*/_jsx(\"td\",{children:(_order$owner=order.owner)===null||_order$owner===void 0?void 0:_order$owner.name}),/*#__PURE__*/_jsx(\"td\",{children:order.count}),/*#__PURE__*/_jsxs(\"td\",{children:[\"$\",order.total]}),/*#__PURE__*/_jsx(\"td\",{children:order.address}),/*#__PURE__*/_jsx(\"td\",{children:order.status==='processing'?/*#__PURE__*/_jsx(Button,{size:\"sm\",onClick:function onClick(){var _order$owner2;return markShipped(order._id,(_order$owner2=order.owner)===null||_order$owner2===void 0?void 0:_order$owner2.id);},children:\"Mark as shipped\"}):/*#__PURE__*/_jsx(Badge,{bg:\"success\",children:\"Shipped\"})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"span\",{style:{cursor:'pointer'},onClick:function onClick(){return showOrder(order.products);},children:[\"View Order \",/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-eye\"})]})})]});});}}return/*#__PURE__*/_jsxs(_Fragment,{children:[\" \",/*#__PURE__*/_jsxs(Table,{responsive:true,striped:true,bordered:true,hover:true,children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"#\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Client name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Items\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Order Total\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Address\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:/*#__PURE__*/_jsx(Pagination,{data:orders,RenderComponent:TableRow,pageLimit:1,dataLimit:10,tablePagination:true})})]}),/*#__PURE__*/_jsxs(Modal,{show:show,onHide:handleClose,children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{children:\"Order Details\"})}),orderToShow.map(function(order){return/*#__PURE__*/_jsxs(\"div\",{className:\"order-details__container d-flex justify-content-around py-2\",children:[/*#__PURE__*/_jsx(\"img\",{src:order.pictures[0].url,style:{maxWidth:100,height:100,objectFit:\"cover\"}}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsxs(\"span\",{children:[order.count,\" x \"]}),order.name]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Price:$\",Number(order.price)*order.count]})]});}),/*#__PURE__*/_jsx(Modal.Footer,{children:/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:handleClose,children:\"Close\"})})]})]});}export default OrdersAdminPage;","map":{"version":3,"names":["React","useEffect","useState","useSelector","axios","Loading","Badge","Button","Modal","Table","Pagination","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","OrdersAdminPage","_useState","_useState2","_slicedToArray","orders","setOrders","_useState3","_useState4","loading","setLoading","products","state","_useState5","_useState6","orderToShow","setOrderToShow","_useState7","_useState8","show","setShow","handleClose","markShipped","orderId","ownerId","patch","concat","then","_ref","data","catch","e","console","log","showOrder","productsObj","productsToShow","filter","product","_id","map","productCopy","_objectSpread","count","description","get","_ref2","length","className","children","TableRow","_ref3","owner","total","status","address","order","_order$owner","name","size","onClick","_order$owner2","id","bg","style","cursor","responsive","striped","bordered","hover","RenderComponent","pageLimit","dataLimit","tablePagination","onHide","Header","closeButton","Title","src","pictures","url","maxWidth","height","objectFit","Number","price","Footer","variant"],"sources":["C:/Users/kandw/Desktop/Ecommerce/ecommerce-frontend/src/components/OrdersAdminPage.js"],"sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport { useSelector } from 'react-redux';\r\nimport axios from '../axios';\r\nimport Loading from './Loading.js'\r\nimport { Badge, Button, Modal, Table } from 'react-bootstrap';\r\nimport Pagination from './Pagination';\r\nfunction OrdersAdminPage() {\r\n    const [orders,setOrders]=useState([]);\r\n    const [loading,setLoading]=useState(false);\r\n    const products=useSelector(state=>state.products);\r\n    const [orderToShow,setOrderToShow]=useState([]);\r\n    const [show,setShow]=useState(false);\r\n\r\n    const handleClose=()=>setShow(false);\r\n\r\n    function markShipped(orderId,ownerId){\r\n        axios.patch(`/orders/${orderId}/mark-shipped`,{ownerId}).then(({data})=>setOrders(data))\r\n        .catch((e)=>console.log(e));\r\n\r\n    }\r\n\r\n    function showOrder(productsObj){\r\n        let productsToShow=products.filter((product)=>productsObj[product._id]);\r\n        productsToShow=productsToShow.map((product)=>{\r\n            const productCopy={...product};\r\n            productCopy.count=productsObj[product._id];\r\n            delete productCopy.description;\r\n            return productCopy;\r\n        });\r\n        setShow(true);\r\n        setOrderToShow(productsToShow);\r\n    }\r\n\r\n    useEffect(()=>{\r\n        setLoading(true);\r\n        axios.get('/orders').then(({data})=>{\r\n            setLoading(false);\r\n            setOrders(data);\r\n        }).catch((e)=>{\r\n            setLoading(false);\r\n        }\r\n    )},[]);\r\n\r\n        if(loading){\r\n            return <Loading />\r\n        }\r\n        if(orders.length===0){\r\n            return <h1 className='text-center pt-4'>No orders yet</h1>\r\n        }\r\n\r\n        function TableRow({_id,count,owner,total,status,products,address}){\r\n            {orders.map(order=>(<tr>\r\n                <td>{order._id}</td>\r\n                <td>{order.owner?.name}</td>\r\n                <td>{order.count}</td>\r\n                <td>${order.total}</td>\r\n                <td>{order.address}</td>\r\n                <td>{order.status==='processing' ?(<Button size=\"sm\" onClick={()=>markShipped(order._id,order.owner?.id)}>Mark as shipped</Button>):<Badge bg=\"success\">Shipped</Badge>}</td>\r\n                <td><span style={{cursor:'pointer'}} onClick={()=>showOrder(order.products)}>\r\n                    View Order <i className=\"fa fa-eye\"></i>\r\n                    </span></td>\r\n            </tr>))}\r\n        }\r\n\r\n  return<> <Table responsive striped bordered hover>\r\n        <thead>\r\n            <tr>\r\n                <th>#</th>\r\n                <th>Client name</th>\r\n                <th>Items</th>\r\n                {/* <th>Status</th> */}\r\n                {/* <th>Date</th> */}\r\n                <th>Order Total</th>\r\n                <th>Address</th>\r\n                {/* <th>&nbsp;</th> */}\r\n            </tr>\r\n        </thead>\r\n        <tbody>\r\n            <Pagination data={orders} RenderComponent={TableRow} pageLimit={1} dataLimit={10} tablePagination={true} />\r\n        </tbody>\r\n    </Table>\r\n    <Modal show={show} onHide={handleClose}>\r\n        <Modal.Header closeButton>\r\n            <Modal.Title>Order Details</Modal.Title>\r\n        </Modal.Header>\r\n        {orderToShow.map(order=>(\r\n            <div className='order-details__container d-flex justify-content-around py-2'>\r\n                <img src={order.pictures[0].url} style={{maxWidth:100,height:100,objectFit:\"cover\"}} />\r\n                <p>\r\n                    <span>{order.count} x </span>{order.name}\r\n                </p>\r\n                <p>Price:${Number(order.price)*order.count}</p>\r\n            </div>\r\n        ))}\r\n        <Modal.Footer>\r\n            <Button variant='secondary' onClick={handleClose}>Close</Button>\r\n        </Modal.Footer>\r\n    </Modal>\r\n    </>\r\n}\r\n\r\nexport default OrdersAdminPage"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}